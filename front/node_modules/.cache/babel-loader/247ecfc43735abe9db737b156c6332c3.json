{"remainingRequest":"C:\\Users\\X240\\Desktop\\OpenClassrooms\\groupomania-lyes\\front\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\X240\\Desktop\\OpenClassrooms\\groupomania-lyes\\front\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\X240\\Desktop\\OpenClassrooms\\groupomania-lyes\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\X240\\Desktop\\OpenClassrooms\\groupomania-lyes\\front\\src\\views\\Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\X240\\Desktop\\OpenClassrooms\\groupomania-lyes\\front\\src\\views\\Login.vue","mtime":1609954819000},{"path":"C:\\Users\\X240\\Desktop\\OpenClassrooms\\groupomania-lyes\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636700259092},{"path":"C:\\Users\\X240\\Desktop\\OpenClassrooms\\groupomania-lyes\\front\\node_modules\\babel-loader\\lib\\index.js","mtime":1636700283426},{"path":"C:\\Users\\X240\\Desktop\\OpenClassrooms\\groupomania-lyes\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636700259092},{"path":"C:\\Users\\X240\\Desktop\\OpenClassrooms\\groupomania-lyes\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":1636700288853}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCBXZWxjb21lTmF2IGZyb20gJy4uL2NvbXBvbmVudHMvV2VsY29tZU5hdi52dWUnOwpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgV2VsY29tZU5hdjogV2VsY29tZU5hdgogIH0sCiAgbmFtZTogJ0xvZ2luJywKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZW1haWw6ICIiLAogICAgICBwYXNzd29yZDogIiIsCiAgICAgIGVycm9yTWVzc2FnZTogIiIKICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICBsb2dpbjogZnVuY3Rpb24gbG9naW4oKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBpZiAodGhpcy5lbWFpbCAmJiB0aGlzLnBhc3N3b3JkKSB7CiAgICAgICAgLy9jb25zdHJ1Y3Rpb24gZGUgbCdvYmpldCAiaWRlbnRpZmlhbnRzIiDDoCBlbnZveWVyIMOgIGwnQVBJCiAgICAgICAgdmFyIGxvZ2luVXNlZCA9IHsKICAgICAgICAgICJlbWFpbCI6IHRoaXMuZW1haWwsCiAgICAgICAgICAicGFzc3dvcmQiOiB0aGlzLnBhc3N3b3JkCiAgICAgICAgfTsKICAgICAgICB2YXIgdXJsID0gImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvdXNlci9sb2dpbiI7CiAgICAgICAgdmFyIG9wdGlvbnMgPSB7CiAgICAgICAgICBtZXRob2Q6ICJQT1NUIiwKICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGxvZ2luVXNlZCksCiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicKICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIGZldGNoKHVybCwgb3B0aW9ucykudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTsKICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgIC8vc2kgbCdBUEkgdmFsaWRlIGxlcyBkb25uw6llcyBldCByZW52b2llIHVuIHRva2VuCiAgICAgICAgICBpZiAocmVzLnVzZXJJRCAmJiByZXMudG9rZW4pIHsKICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oInVzZXJJRCIsIHJlcy51c2VySUQpOwogICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgidG9rZW4iLCByZXMudG9rZW4pOwogICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgiYWRtaW5SaWdodHMiLCByZXMuYWRtaW5SaWdodHMpOwogICAgICAgICAgICBjb25zb2xlLmxvZyhsb2NhbFN0b3JhZ2UpOwoKICAgICAgICAgICAgX3RoaXMuJHJvdXRlci5wdXNoKCJmb3J1bSIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy9zaW5vbiBhZmZpY2hlciBsZSBtZXNzYWdlIGQnZXJyZXVyIGNvcnJlc3BvbmRhbnQgc291cyBsZSBmb3JtdWxhaXJlCiAgICAgICAgICAgIF90aGlzLmVycm9yTWVzc2FnZSA9IHJlcy5tZXNzYWdlOwogICAgICAgICAgfQogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKGVycm9yKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIGxvY2FsU3RvcmFnZS5jbGVhcigpOwogIH0KfTs="},{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA,OAAA,UAAA,MAAA,8BAAA;AACA,eAAA;AACA,EAAA,UAAA,EAAA;AAAA,IAAA,UAAA,EAAA;AAAA,GADA;AAEA,EAAA,IAAA,EAAA,OAFA;AAGA,EAAA,IAAA,EAAA,gBAAA;AACA,WAAA;AACA,MAAA,KAAA,EAAA,EADA;AAEA,MAAA,QAAA,EAAA,EAFA;AAGA,MAAA,YAAA,EAAA;AAHA,KAAA;AAKA,GATA;AAUA,EAAA,OAAA,EAAA;AACA,IAAA,KADA,mBACA;AAAA;;AACA,UAAA,KAAA,KAAA,IAAA,KAAA,QAAA,EAAA;AACA;AACA,YAAA,SAAA,GAAA;AACA,mBAAA,KAAA,KADA;AAEA,sBAAA,KAAA;AAFA,SAAA;AAIA,YAAA,GAAA,GAAA,sCAAA;AACA,YAAA,OAAA,GAAA;AACA,UAAA,MAAA,EAAA,MADA;AAEA,UAAA,IAAA,EAAA,IAAA,CAAA,SAAA,CAAA,SAAA,CAFA;AAGA,UAAA,OAAA,EAAA;AACA,4BAAA;AADA;AAHA,SAAA;AAOA,QAAA,KAAA,CAAA,GAAA,EAAA,OAAA,CAAA,CACA,IADA,CACA,UAAA,GAAA;AAAA,iBAAA,GAAA,CAAA,IAAA,EAAA;AAAA,SADA,EAEA,IAFA,CAEA,UAAA,GAAA,EAAA;AACA;AACA,cAAA,GAAA,CAAA,MAAA,IAAA,GAAA,CAAA,KAAA,EAAA;AACA,YAAA,YAAA,CAAA,OAAA,CAAA,QAAA,EAAA,GAAA,CAAA,MAAA;AACA,YAAA,YAAA,CAAA,OAAA,CAAA,OAAA,EAAA,GAAA,CAAA,KAAA;AACA,YAAA,YAAA,CAAA,OAAA,CAAA,aAAA,EAAA,GAAA,CAAA,WAAA;AACA,YAAA,OAAA,CAAA,GAAA,CAAA,YAAA;;AACA,YAAA,KAAA,CAAA,OAAA,CAAA,IAAA,CAAA,OAAA;AACA,WANA,MAMA;AACA;AACA,YAAA,KAAA,CAAA,YAAA,GAAA,GAAA,CAAA,OAAA;AACA;AACA,SAdA,EAeA,KAfA,CAeA,UAAA,KAAA;AAAA,iBAAA,OAAA,CAAA,GAAA,CAAA,KAAA,CAAA;AAAA,SAfA;AAgBA;AACA;AAjCA,GAVA;AA6CA,EAAA,OA7CA,qBA6CA;AACA,IAAA,YAAA,CAAA,KAAA;AACA;AA/CA,CAAA","sourcesContent":["<template>\n    <div class=\"container welcome-container full-height\">\n        <WelcomeNav></WelcomeNav>\n        <h1>Accédez à votre espace personnel</h1>\n        <form v-on:submit.prevent=\"login\" class=\"welcome-form\">\n            <fieldset>\n                <label for=\"email\">Email *\n                    <input\n                        type=\"email\"\n                        id=\"email\"\n                        required\n                        placeholder=\"Entrez une adresse email valide\"\n                        name=\"email\"\n                        maxlength=\"60\"\n                        aria-label=\"Entrez votre email\"\n                        v-model=\"email\"\n                    />\n                </label>\n            </fieldset>\n            <fieldset>\n                <label for=\"password\">Mot de passe *\n                    <input\n                        type=\"password\"\n                        id=\"password\"\n                        required\n                        placeholder=\"Renseignez votre mot de passe\"\n                        name=\"password\"\n                        aria-label=\"Entrez votre mot de passe\"\n                        aria-describedby=\"passwordInfo\"\n                        v-model=\"password\"\n                    />\n                </label>\n            </fieldset>\n            <p v-if=\"errorMessage.length >= 1\" class=\"alert-msg\">{{ errorMessage }}</p>\n            <button>Se Connecter</button>\n        </form>\n    </div>\n</template>\n\n<script>\nimport WelcomeNav from '../components/WelcomeNav.vue'\nexport default {\n    components: { WelcomeNav },\n    name: 'Login',\n    data: () => {\n        return {\n            email: \"\",\n            password: \"\",\n            errorMessage: \"\"\n        }\n    },\n    methods: {\n        login() {\n            if (this.email && this.password) {\n                //construction de l'objet \"identifiants\" à envoyer à l'API\n                let loginUsed = {\n                    \"email\": this.email,\n                    \"password\": this.password\n                }\n                let url = \"http://localhost:3000/api/user/login\"\n                let options = {\n                    method: \"POST\",\n                    body: JSON.stringify(loginUsed),\n                    headers: {\n                        'Content-Type': 'application/json'\n                    }\n                }\n                fetch(url, options)\n                    .then(res => res.json())\n                    .then((res) => {\n                        //si l'API valide les données et renvoie un token\n                        if (res.userID && res.token) {\n                            localStorage.setItem(\"userID\", res.userID)\n                            localStorage.setItem(\"token\", res.token)\n                            localStorage.setItem(\"adminRights\", res.adminRights)\n                            console.log(localStorage)\n                            this.$router.push(\"forum\");\n                        } else {\n                            //sinon afficher le message d'erreur correspondant sous le formulaire\n                            this.errorMessage = res.message\n                        }\n                    })\n                .catch(error => console.log(error))\n            }\n        }\n    },\n    mounted() {\n        localStorage.clear();\n    }\n}\n</script>\n\n<style lang=\"css\">\n@import \"../style/style.css\";\n</style>\n"],"sourceRoot":"src/views"}]}