{"remainingRequest":"C:\\Users\\X240\\Desktop\\OpenClassrooms\\groupomania-lyes\\front\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\X240\\Desktop\\OpenClassrooms\\groupomania-lyes\\front\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\X240\\Desktop\\OpenClassrooms\\groupomania-lyes\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\X240\\Desktop\\OpenClassrooms\\groupomania-lyes\\front\\src\\views\\UserProfile.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\X240\\Desktop\\OpenClassrooms\\groupomania-lyes\\front\\src\\views\\UserProfile.vue","mtime":1609954819000},{"path":"C:\\Users\\X240\\Desktop\\OpenClassrooms\\groupomania-lyes\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636700259092},{"path":"C:\\Users\\X240\\Desktop\\OpenClassrooms\\groupomania-lyes\\front\\node_modules\\babel-loader\\lib\\index.js","mtime":1636700283426},{"path":"C:\\Users\\X240\\Desktop\\OpenClassrooms\\groupomania-lyes\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636700259092},{"path":"C:\\Users\\X240\\Desktop\\OpenClassrooms\\groupomania-lyes\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":1636700288853}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCBIb21lTmF2IGZyb20gJy4uL2NvbXBvbmVudHMvSG9tZU5hdic7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnVXNlclByb2ZpbGUnLAogIGNvbXBvbmVudHM6IHsKICAgIEhvbWVOYXY6IEhvbWVOYXYKICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB1cGRhdGVNZXNzYWdlOiAiIiwKICAgICAgdXNlclByb2ZpbGU6IHsKICAgICAgICB1c2VySUQ6IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ1c2VySUQiKSwKICAgICAgICBmaXJzdE5hbWU6ICIiLAogICAgICAgIGxhc3ROYW1lOiAiIiwKICAgICAgICBhdmF0YXJVcmw6ICIiCiAgICAgIH0sCiAgICAgIG5ld1Byb2ZpbGU6IHt9CiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgc2V0UHJvZmlsZTogZnVuY3Rpb24gc2V0UHJvZmlsZSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciB1cmwgPSAiaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS91c2VyLyIuY29uY2F0KHRoaXMudXNlclByb2ZpbGUudXNlcklEKTsKICAgICAgdmFyIG9wdGlvbnMgPSB7CiAgICAgICAgbWV0aG9kOiAiR0VUIiwKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAnQXV0aG9yaXphdGlvbic6ICdCZWFyZXIgJyArIGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ0b2tlbiIpCiAgICAgICAgfQogICAgICB9OwogICAgICBmZXRjaCh1cmwsIG9wdGlvbnMpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTsKICAgICAgfSkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIF90aGlzLnVzZXJQcm9maWxlLmZpcnN0TmFtZSA9IGRhdGFbMF0uZmlyc3ROYW1lOwogICAgICAgIF90aGlzLnVzZXJQcm9maWxlLmxhc3ROYW1lID0gZGF0YVswXS5sYXN0TmFtZTsKICAgICAgICBfdGhpcy51c2VyUHJvZmlsZS5hdmF0YXJVcmwgPSBkYXRhWzBdLmF2YXRhclVybDsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKGVycm9yKTsKICAgICAgfSk7CiAgICB9LAogICAgdXBkYXRlQXZhdGFyOiBmdW5jdGlvbiB1cGRhdGVBdmF0YXIoZXZlbnQpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTsKICAgICAgZm9ybURhdGEuYXBwZW5kKCJpbWFnZSIsIGV2ZW50LnRhcmdldC5maWxlc1swXSk7CiAgICAgIHZhciB1cmwgPSAiaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS91c2VyLyIuY29uY2F0KHRoaXMudXNlclByb2ZpbGUudXNlcklEKTsKICAgICAgdmFyIG9wdGlvbnMgPSB7CiAgICAgICAgbWV0aG9kOiAiUE9TVCIsCiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiAnQmVhcmVyICcgKyBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidG9rZW4iKQogICAgICAgIH0sCiAgICAgICAgYm9keTogZm9ybURhdGEKICAgICAgfTsKICAgICAgZmV0Y2godXJsLCBvcHRpb25zKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICByZXR1cm4gcmVzLmpzb24oKTsKICAgICAgfSkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIF90aGlzMi51c2VyUHJvZmlsZS5hdmF0YXJVcmwgPSBkYXRhOwogICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczIudXBkYXRlTWVzc2FnZSA9ICJWb3RyZSBwaG90byBkZSBwcm9maWwgYSBiaWVuIMOpdMOpIG1pc2Ugw6Agam91ciI7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIHJldHVybiBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgIH0pOwogICAgfSwKICAgIG1vZGlmeVByb2ZpbGU6IGZ1bmN0aW9uIG1vZGlmeVByb2ZpbGUoKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdmFyIHVybCA9ICJodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL3VzZXIvIi5jb25jYXQodGhpcy51c2VyUHJvZmlsZS51c2VySUQpOwogICAgICB2YXIgb3B0aW9ucyA9IHsKICAgICAgICBtZXRob2Q6ICJQVVQiLAogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICdBdXRob3JpemF0aW9uJzogJ0JlYXJlciAnICsgbG9jYWxTdG9yYWdlLmdldEl0ZW0oInRva2VuIiksCiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nCiAgICAgICAgfSwKICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh0aGlzLm5ld1Byb2ZpbGUpCiAgICAgIH07CiAgICAgIGZldGNoKHVybCwgb3B0aW9ucykudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAvL3LDqWN1cMOpcmVyIGxlIHByb2ZpbCBtaXMgw6Agam91cgogICAgICAgIF90aGlzMy51c2VyUHJvZmlsZSA9IGRhdGFbMF07IC8vcsOpaW5pdGlhbGlzZXIgbGVzIGNoYW1wcyBkZSBmb3JtdWxhaXJlCgogICAgICAgIF90aGlzMy5uZXdQcm9maWxlID0ge307CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIHJldHVybiBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgIH0pOwogICAgfSwKICAgIGRlbGV0ZVByb2ZpbGU6IGZ1bmN0aW9uIGRlbGV0ZVByb2ZpbGUoKSB7CiAgICAgIHZhciB1cmwgPSAiaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS91c2VyLyIuY29uY2F0KHRoaXMudXNlclByb2ZpbGUudXNlcklEKTsKICAgICAgdmFyIG9wdGlvbnMgPSB7CiAgICAgICAgbWV0aG9kOiAiREVMRVRFIiwKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAnQXV0aG9yaXphdGlvbic6ICdCZWFyZXIgJyArIGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ0b2tlbiIpCiAgICAgICAgfQogICAgICB9OwogICAgICBmZXRjaCh1cmwsIG9wdGlvbnMpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIHJldHVybiByZXMuanNvbigpOwogICAgICB9KS50aGVuKHRoaXMuJHJvdXRlci5wdXNoKCIvaW5zY3JpcHRpb24iKSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKGVycm9yKTsKICAgICAgfSk7CiAgICB9CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgdGhpcy5zZXRQcm9maWxlKCk7CiAgfQp9Ow=="},{"version":3,"sources":["UserProfile.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div class=\"container\">\n        <HomeNav></HomeNav>\n        <h1>Modifier votre profil</h1>\n        <form>\n            <fieldset>\n                <img\n                    class=\"avatar\"\n                    :src=\"userProfile.avatarUrl\"\n                />\n                <label for=\"new-avatar-url\">Changer de photo de profil\n                    <input\n                        v-on:change=\"updateAvatar\"\n                        id=\"new-avatar-url\"\n                        type=\"file\"\n                        accept=\"image/*\"\n                    />\n                </label>\n            </fieldset>\n            <fieldset>\n                <label for=\"new-first-name\">Votre prénom n'est pas\n                    <span class=\"bold-text\">{{ userProfile.firstName }}</span> ?\n                    <input\n                        v-model=\"newProfile.firstName\"\n                        id=\"new-first-name\"\n                        placeholder=\"Votre vrai prénom\"\n                    />\n                </label>\n            </fieldset>\n            <fieldset>\n                <label for=\"new-last-name\">Votre nom n'est pas\n                    <span class=\"bold-text\">{{ userProfile.lastName }}</span> ?\n                    <input v-model=\"newProfile.lastName\"\n                        id=\"new-last-name\"\n                        placeholder=\"Votre vrai nom\"\n                    />\n                </label>\n            </fieldset>\n            <p v-if=\"updateMessage.length >= 1\" class=\"alert-msg\">{{ updateMessage }}</p>\n            <button @click=\"modifyProfile\" id=\"modify-user\">Modifier votre profil</button>\n            <button @click=\"deleteProfile\" id=\"delete-user\">Supprimer votre compte</button>\n        </form>\n    </div>\n</template>\n\n<script>\nimport HomeNav from '../components/HomeNav'\nexport default {\n    name: 'UserProfile',\n    components: {\n        HomeNav\n    },\n    data() {\n        return {\n            updateMessage: \"\",\n            userProfile: {\n                userID: localStorage.getItem(\"userID\"),\n                firstName: \"\",\n                lastName: \"\",\n                avatarUrl: \"\"\n            },\n            newProfile: {},\n        }\n    },\n    methods: {\n        setProfile() {\n            let url = `http://localhost:3000/api/user/${ this.userProfile.userID }`;\n            let options = {\n                method: \"GET\",\n                headers: {\n                    'Authorization': 'Bearer ' + localStorage.getItem(\"token\"),\n                }\n            };\n            fetch(url, options)\n                .then(response => response.json())\n                .then(data => {\n                    this.userProfile.firstName = data[0].firstName;\n                    this.userProfile.lastName = data[0].lastName;\n                    this.userProfile.avatarUrl = data[0].avatarUrl;\n                })\n                .catch(error => console.log(error))\n        },\n        updateAvatar(event) {\n            const formData = new FormData();\n            formData.append(\"image\", event.target.files[0]);\n            let url = `http://localhost:3000/api/user/${ this.userProfile.userID }`;\n            let options = {\n                method: \"POST\",\n                headers: { 'Authorization': 'Bearer ' + localStorage.getItem(\"token\") },\n                body: formData\n            };\n            fetch(url, options)\n                .then(res => res.json())\n                .then(data => {\n                    this.userProfile.avatarUrl = data;\n                })\n                .then(() => {\n                    this.updateMessage = \"Votre photo de profil a bien été mise à jour\";\n                })\n                .catch(error => console.log(error))\n        },\n        modifyProfile() {\n            let url = `http://localhost:3000/api/user/${ this.userProfile.userID }`;\n            let options = {\n                method: \"PUT\",\n                headers: {\n                    'Authorization': 'Bearer ' + localStorage.getItem(\"token\"),\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify(this.newProfile),\n            };\n            fetch(url, options)\n                .then(res => res.json())\n                .then(data => {\n                    //récupérer le profil mis à jour\n                    this.userProfile = data[0];\n                    //réinitialiser les champs de formulaire\n                    this.newProfile = {}\n                })\n                .catch(error => console.log(error))\n        },\n        deleteProfile() {\n            let url = `http://localhost:3000/api/user/${ this.userProfile.userID }`;\n            let options = {\n                method: \"DELETE\",\n                headers: {\n                    'Authorization': 'Bearer ' + localStorage.getItem(\"token\"),\n                }\n            };\n            fetch(url, options)\n                .then(res => res.json())\n                .then(this.$router.push(\"/inscription\"))\n                .catch(error => console.log(error))\n        },\n    },\n    mounted() {\n        this.setProfile();\n    }\n}\n</script>\n\n<style lang=\"css\">\n  @import '../style/style.css'\n</style>"],"sourceRoot":"src/views"}]}