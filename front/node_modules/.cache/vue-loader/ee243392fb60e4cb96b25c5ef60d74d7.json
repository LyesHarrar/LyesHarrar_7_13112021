{"remainingRequest":"C:\\Users\\X240\\Desktop\\OpenClassrooms\\groupomania-lyes\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\X240\\Desktop\\OpenClassrooms\\groupomania-lyes\\front\\src\\views\\UserProfile.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\X240\\Desktop\\OpenClassrooms\\groupomania-lyes\\front\\src\\views\\UserProfile.vue","mtime":1609954819000},{"path":"C:\\Users\\X240\\Desktop\\OpenClassrooms\\groupomania-lyes\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636700259092},{"path":"C:\\Users\\X240\\Desktop\\OpenClassrooms\\groupomania-lyes\\front\\node_modules\\babel-loader\\lib\\index.js","mtime":1636700283426},{"path":"C:\\Users\\X240\\Desktop\\OpenClassrooms\\groupomania-lyes\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636700259092},{"path":"C:\\Users\\X240\\Desktop\\OpenClassrooms\\groupomania-lyes\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":1636700288853}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBIb21lTmF2IGZyb20gJy4uL2NvbXBvbmVudHMvSG9tZU5hdicKZXhwb3J0IGRlZmF1bHQgewogICAgbmFtZTogJ1VzZXJQcm9maWxlJywKICAgIGNvbXBvbmVudHM6IHsKICAgICAgICBIb21lTmF2CiAgICB9LAogICAgZGF0YSgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICB1cGRhdGVNZXNzYWdlOiAiIiwKICAgICAgICAgICAgdXNlclByb2ZpbGU6IHsKICAgICAgICAgICAgICAgIHVzZXJJRDogbG9jYWxTdG9yYWdlLmdldEl0ZW0oInVzZXJJRCIpLAogICAgICAgICAgICAgICAgZmlyc3ROYW1lOiAiIiwKICAgICAgICAgICAgICAgIGxhc3ROYW1lOiAiIiwKICAgICAgICAgICAgICAgIGF2YXRhclVybDogIiIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgbmV3UHJvZmlsZToge30sCiAgICAgICAgfQogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICBzZXRQcm9maWxlKCkgewogICAgICAgICAgICBsZXQgdXJsID0gYGh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvdXNlci8keyB0aGlzLnVzZXJQcm9maWxlLnVzZXJJRCB9YDsKICAgICAgICAgICAgbGV0IG9wdGlvbnMgPSB7CiAgICAgICAgICAgICAgICBtZXRob2Q6ICJHRVQiLAogICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogJ0JlYXJlciAnICsgbG9jYWxTdG9yYWdlLmdldEl0ZW0oInRva2VuIiksCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGZldGNoKHVybCwgb3B0aW9ucykKICAgICAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSkKICAgICAgICAgICAgICAgIC50aGVuKGRhdGEgPT4gewogICAgICAgICAgICAgICAgICAgIHRoaXMudXNlclByb2ZpbGUuZmlyc3ROYW1lID0gZGF0YVswXS5maXJzdE5hbWU7CiAgICAgICAgICAgICAgICAgICAgdGhpcy51c2VyUHJvZmlsZS5sYXN0TmFtZSA9IGRhdGFbMF0ubGFzdE5hbWU7CiAgICAgICAgICAgICAgICAgICAgdGhpcy51c2VyUHJvZmlsZS5hdmF0YXJVcmwgPSBkYXRhWzBdLmF2YXRhclVybDsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4gY29uc29sZS5sb2coZXJyb3IpKQogICAgICAgIH0sCiAgICAgICAgdXBkYXRlQXZhdGFyKGV2ZW50KSB7CiAgICAgICAgICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7CiAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgiaW1hZ2UiLCBldmVudC50YXJnZXQuZmlsZXNbMF0pOwogICAgICAgICAgICBsZXQgdXJsID0gYGh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvdXNlci8keyB0aGlzLnVzZXJQcm9maWxlLnVzZXJJRCB9YDsKICAgICAgICAgICAgbGV0IG9wdGlvbnMgPSB7CiAgICAgICAgICAgICAgICBtZXRob2Q6ICJQT1NUIiwKICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsgJ0F1dGhvcml6YXRpb24nOiAnQmVhcmVyICcgKyBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidG9rZW4iKSB9LAogICAgICAgICAgICAgICAgYm9keTogZm9ybURhdGEKICAgICAgICAgICAgfTsKICAgICAgICAgICAgZmV0Y2godXJsLCBvcHRpb25zKQogICAgICAgICAgICAgICAgLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpCiAgICAgICAgICAgICAgICAudGhlbihkYXRhID0+IHsKICAgICAgICAgICAgICAgICAgICB0aGlzLnVzZXJQcm9maWxlLmF2YXRhclVybCA9IGRhdGE7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4gewogICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlTWVzc2FnZSA9ICJWb3RyZSBwaG90byBkZSBwcm9maWwgYSBiaWVuIMOpdMOpIG1pc2Ugw6Agam91ciI7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IGNvbnNvbGUubG9nKGVycm9yKSkKICAgICAgICB9LAogICAgICAgIG1vZGlmeVByb2ZpbGUoKSB7CiAgICAgICAgICAgIGxldCB1cmwgPSBgaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS91c2VyLyR7IHRoaXMudXNlclByb2ZpbGUudXNlcklEIH1gOwogICAgICAgICAgICBsZXQgb3B0aW9ucyA9IHsKICAgICAgICAgICAgICAgIG1ldGhvZDogIlBVVCIsCiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiAnQmVhcmVyICcgKyBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidG9rZW4iKSwKICAgICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkodGhpcy5uZXdQcm9maWxlKSwKICAgICAgICAgICAgfTsKICAgICAgICAgICAgZmV0Y2godXJsLCBvcHRpb25zKQogICAgICAgICAgICAgICAgLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpCiAgICAgICAgICAgICAgICAudGhlbihkYXRhID0+IHsKICAgICAgICAgICAgICAgICAgICAvL3LDqWN1cMOpcmVyIGxlIHByb2ZpbCBtaXMgw6Agam91cgogICAgICAgICAgICAgICAgICAgIHRoaXMudXNlclByb2ZpbGUgPSBkYXRhWzBdOwogICAgICAgICAgICAgICAgICAgIC8vcsOpaW5pdGlhbGlzZXIgbGVzIGNoYW1wcyBkZSBmb3JtdWxhaXJlCiAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXdQcm9maWxlID0ge30KICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4gY29uc29sZS5sb2coZXJyb3IpKQogICAgICAgIH0sCiAgICAgICAgZGVsZXRlUHJvZmlsZSgpIHsKICAgICAgICAgICAgbGV0IHVybCA9IGBodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL3VzZXIvJHsgdGhpcy51c2VyUHJvZmlsZS51c2VySUQgfWA7CiAgICAgICAgICAgIGxldCBvcHRpb25zID0gewogICAgICAgICAgICAgICAgbWV0aG9kOiAiREVMRVRFIiwKICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6ICdCZWFyZXIgJyArIGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ0b2tlbiIpLAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgICAgICBmZXRjaCh1cmwsIG9wdGlvbnMpCiAgICAgICAgICAgICAgICAudGhlbihyZXMgPT4gcmVzLmpzb24oKSkKICAgICAgICAgICAgICAgIC50aGVuKHRoaXMuJHJvdXRlci5wdXNoKCIvaW5zY3JpcHRpb24iKSkKICAgICAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiBjb25zb2xlLmxvZyhlcnJvcikpCiAgICAgICAgfSwKICAgIH0sCiAgICBtb3VudGVkKCkgewogICAgICAgIHRoaXMuc2V0UHJvZmlsZSgpOwogICAgfQp9Cg=="},{"version":3,"sources":["UserProfile.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"UserProfile.vue","sourceRoot":"src/views","sourcesContent":["<template>\n    <div class=\"container\">\n        <HomeNav></HomeNav>\n        <h1>Modifier votre profil</h1>\n        <form>\n            <fieldset>\n                <img\n                    class=\"avatar\"\n                    :src=\"userProfile.avatarUrl\"\n                />\n                <label for=\"new-avatar-url\">Changer de photo de profil\n                    <input\n                        v-on:change=\"updateAvatar\"\n                        id=\"new-avatar-url\"\n                        type=\"file\"\n                        accept=\"image/*\"\n                    />\n                </label>\n            </fieldset>\n            <fieldset>\n                <label for=\"new-first-name\">Votre prénom n'est pas\n                    <span class=\"bold-text\">{{ userProfile.firstName }}</span> ?\n                    <input\n                        v-model=\"newProfile.firstName\"\n                        id=\"new-first-name\"\n                        placeholder=\"Votre vrai prénom\"\n                    />\n                </label>\n            </fieldset>\n            <fieldset>\n                <label for=\"new-last-name\">Votre nom n'est pas\n                    <span class=\"bold-text\">{{ userProfile.lastName }}</span> ?\n                    <input v-model=\"newProfile.lastName\"\n                        id=\"new-last-name\"\n                        placeholder=\"Votre vrai nom\"\n                    />\n                </label>\n            </fieldset>\n            <p v-if=\"updateMessage.length >= 1\" class=\"alert-msg\">{{ updateMessage }}</p>\n            <button @click=\"modifyProfile\" id=\"modify-user\">Modifier votre profil</button>\n            <button @click=\"deleteProfile\" id=\"delete-user\">Supprimer votre compte</button>\n        </form>\n    </div>\n</template>\n\n<script>\nimport HomeNav from '../components/HomeNav'\nexport default {\n    name: 'UserProfile',\n    components: {\n        HomeNav\n    },\n    data() {\n        return {\n            updateMessage: \"\",\n            userProfile: {\n                userID: localStorage.getItem(\"userID\"),\n                firstName: \"\",\n                lastName: \"\",\n                avatarUrl: \"\"\n            },\n            newProfile: {},\n        }\n    },\n    methods: {\n        setProfile() {\n            let url = `http://localhost:3000/api/user/${ this.userProfile.userID }`;\n            let options = {\n                method: \"GET\",\n                headers: {\n                    'Authorization': 'Bearer ' + localStorage.getItem(\"token\"),\n                }\n            };\n            fetch(url, options)\n                .then(response => response.json())\n                .then(data => {\n                    this.userProfile.firstName = data[0].firstName;\n                    this.userProfile.lastName = data[0].lastName;\n                    this.userProfile.avatarUrl = data[0].avatarUrl;\n                })\n                .catch(error => console.log(error))\n        },\n        updateAvatar(event) {\n            const formData = new FormData();\n            formData.append(\"image\", event.target.files[0]);\n            let url = `http://localhost:3000/api/user/${ this.userProfile.userID }`;\n            let options = {\n                method: \"POST\",\n                headers: { 'Authorization': 'Bearer ' + localStorage.getItem(\"token\") },\n                body: formData\n            };\n            fetch(url, options)\n                .then(res => res.json())\n                .then(data => {\n                    this.userProfile.avatarUrl = data;\n                })\n                .then(() => {\n                    this.updateMessage = \"Votre photo de profil a bien été mise à jour\";\n                })\n                .catch(error => console.log(error))\n        },\n        modifyProfile() {\n            let url = `http://localhost:3000/api/user/${ this.userProfile.userID }`;\n            let options = {\n                method: \"PUT\",\n                headers: {\n                    'Authorization': 'Bearer ' + localStorage.getItem(\"token\"),\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify(this.newProfile),\n            };\n            fetch(url, options)\n                .then(res => res.json())\n                .then(data => {\n                    //récupérer le profil mis à jour\n                    this.userProfile = data[0];\n                    //réinitialiser les champs de formulaire\n                    this.newProfile = {}\n                })\n                .catch(error => console.log(error))\n        },\n        deleteProfile() {\n            let url = `http://localhost:3000/api/user/${ this.userProfile.userID }`;\n            let options = {\n                method: \"DELETE\",\n                headers: {\n                    'Authorization': 'Bearer ' + localStorage.getItem(\"token\"),\n                }\n            };\n            fetch(url, options)\n                .then(res => res.json())\n                .then(this.$router.push(\"/inscription\"))\n                .catch(error => console.log(error))\n        },\n    },\n    mounted() {\n        this.setProfile();\n    }\n}\n</script>\n\n<style lang=\"css\">\n  @import '../style/style.css'\n</style>"]}]}